Search.setIndex({docnames:["clipping","compute_dp_sgd_privacy","dp_multihead_attention","index","layers","module_inspection","module_modification","per_sample_gradient_clip","per_sample_gradients","privacy_analysis","privacy_engine","scripts","stats","tensor_utils","utils"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["clipping.rst","compute_dp_sgd_privacy.rst","dp_multihead_attention.rst","index.rst","layers.rst","module_inspection.rst","module_modification.rst","per_sample_gradient_clip.rst","per_sample_gradients.rst","privacy_analysis.rst","privacy_engine.rst","scripts.rst","stats.rst","tensor_utils.rst","utils.rst"],objects:{"opacus.autograd_grad_sample":{add_hooks:[8,1,1,""],disable_hooks:[8,1,1,""],enable_hooks:[8,1,1,""],is_supported:[8,1,1,""],remove_hooks:[8,1,1,""]},"opacus.layers":{dp_multihead_attention:[2,0,0,"-"]},"opacus.layers.dp_multihead_attention":{DPMultiheadAttention:[2,2,1,""],SequenceBias:[2,2,1,""]},"opacus.layers.dp_multihead_attention.DPMultiheadAttention":{forward:[2,3,1,""],load_state_dict:[2,3,1,""]},"opacus.layers.dp_multihead_attention.SequenceBias":{bias:[2,4,1,""],forward:[2,3,1,""]},"opacus.per_sample_gradient_clip":{PerSampleGradientClipper:[7,2,1,""]},"opacus.per_sample_gradient_clip.PerSampleGradientClipper":{clip_and_accumulate:[7,3,1,""],close:[7,3,1,""],pre_step:[7,3,1,""],set_on_batch_clip_func:[7,3,1,""]},"opacus.privacy_analysis":{compute_rdp:[9,1,1,""],get_privacy_spent:[9,1,1,""]},"opacus.privacy_engine":{PrivacyEngine:[10,2,1,""]},"opacus.privacy_engine.PrivacyEngine":{attach:[10,3,1,""],detach:[10,3,1,""],get_privacy_spent:[10,3,1,""],step:[10,3,1,""],to:[10,3,1,""],virtual_step:[10,3,1,""]},"opacus.scripts":{compute_dp_sgd_privacy:[1,0,0,"-"]},"opacus.scripts.compute_dp_sgd_privacy":{compute_dp_sgd_privacy:[1,1,1,""]},"opacus.supported_layers_grad_samplers":{_supported_layers_grad_samplers:[8,4,1,""]},"opacus.utils":{clipping:[0,0,0,"-"],module_inspection:[5,0,0,"-"],module_modification:[6,0,0,"-"],stats:[12,0,0,"-"],tensor_utils:[13,0,0,"-"]},"opacus.utils.clipping":{ClippingMethod:[0,2,1,""],ConstantFlatClipper:[0,2,1,""],ConstantPerLayerClipper:[0,2,1,""],NormClipper:[0,2,1,""]},"opacus.utils.clipping.ConstantFlatClipper":{calc_clipping_factors:[0,3,1,""],is_per_layer:[0,3,1,""],thresholds:[0,3,1,""]},"opacus.utils.clipping.ConstantPerLayerClipper":{calc_clipping_factors:[0,3,1,""],is_per_layer:[0,3,1,""],thresholds:[0,3,1,""]},"opacus.utils.clipping.NormClipper":{calc_clipping_factors:[0,3,1,""],is_per_layer:[0,3,1,""],thresholds:[0,3,1,""]},"opacus.utils.module_inspection":{ModelInspector:[5,2,1,""],get_layer_type:[5,1,1,""],has_no_param:[5,1,1,""],requires_grad:[5,1,1,""]},"opacus.utils.module_inspection.ModelInspector":{validate:[5,3,1,""]},"opacus.utils.module_modification":{convert_batchnorm_modules:[6,1,1,""],nullify_batchnorm_modules:[6,1,1,""],replace_all_modules:[6,1,1,""]},"opacus.utils.stats":{Stat:[12,2,1,""],StatType:[12,2,1,""],add:[12,1,1,""],clear:[12,1,1,""],remove:[12,1,1,""],reset:[12,1,1,""],set_global_summary_writer:[12,1,1,""],update:[12,1,1,""]},"opacus.utils.stats.Stat":{log:[12,3,1,""],reset:[12,3,1,""]},"opacus.utils.tensor_utils":{calc_sample_norms:[13,1,1,""],sum_over_all_but_batch_and_last_n:[13,1,1,""]},opacus:{autograd_grad_sample:[8,0,0,"-"],per_sample_gradient_clip:[7,0,0,"-"],privacy_analysis:[9,0,0,"-"],privacy_engine:[10,0,0,"-"],supported_layers_grad_samplers:[8,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","function","Python function"],"2":["py","class","Python class"],"3":["py","method","Python method"],"4":["py","attribute","Python attribute"]},objtypes:{"0":"py:module","1":"py:function","2":"py:class","3":"py:method","4":"py:attribute"},terms:{"0618":13,"0th":13,"100":1,"128":10,"2048":10,"256":1,"5117":13,"598":8,"60000":1,"abstract":0,"boolean":5,"case":0,"class":[0,2,5,6,7,10,12],"default":[6,10,12],"enum":12,"final":[0,7],"float":[0,1,9,10,12],"function":[1,2,5,6,7,8,9,10,12,13],"import":[6,10],"int":[1,2,7,9,10,13],"new":0,"return":[0,1,5,6,7,8,9,10,13],"true":[0,1,2,5,7,8,10,13],"while":[2,10],For:[0,2,10],Its:[9,12],That:10,The:[0,1,5,7,8,9,10,12],Then:10,There:7,Use:12,Used:10,Useful:12,_batchnorm:6,_batchnorm_to_groupnorm:6,_supported_layers_grad_sampl:8,about:[5,12],acc1:12,acc1_valu:12,account:[1,10],accumul:[7,10,12],accuraci:12,achiev:7,across:12,activ:[8,12],add:[2,8,10,12],add_bias_kv:2,add_hook:8,add_scalar:12,add_zero_attn:2,added:[1,7,8,9,10,12],adding:[7,12],addit:9,advantag:10,affect:[6,7,12],after:[7,10],afterward:2,aggreg:[7,8,10,13],all:[0,2,5,6,7,8,9,10,12,13],alloc:10,allow:[2,12],alpha:[1,9,10],alreadi:12,altern:10,although:2,alwai:[5,7,8],amount:10,analysi:[1,3],ani:[5,10,12],anoth:[6,12],appear:[7,8],appli:[0,1,5,7,9],arbitrari:10,arg:12,argument:10,around:12,arrai:9,assum:13,attach:[7,10,12],attn_mask:2,attribut:10,autograd:3,autograd_grad_sampl:8,automat:10,avail:8,averag:[7,10,12],avg:12,b_sz:7,back:7,backprop:8,backpropag:[7,8],backward:[7,8,10],base:[0,1,2,8,9],batch:[1,2,7,8,10,13],batch_first:[7,8,10],batch_siz:[1,7,8,10],batchnorm1d:6,batchnorm2d:6,batchnorm:6,been:8,befor:[0,7,10],behaviour:8,being:[5,8,13],benefici:10,best:10,better:0,bia:2,blob:[1,9],block:2,bn1:6,bool:[0,1,5,7,8,10,13],both:2,bound:[0,7],budget:[1,10],build:2,busi:10,calc_clipping_factor:0,calc_sample_norm:13,calcul:[0,2,8,13],call:[1,2,7,10,12],callabl:[5,6,7,8],can:[1,7,8,9,10,12],cannot:7,cap:0,captur:8,care:2,cat:7,check:[5,8],check_leaf_nodes_onli:5,children:5,clear:12,clip:[3,10,12,14],clip_and_accumul:7,clipper:[0,7,10],clippingmethod:0,close:7,code:[1,9,12],collect:[7,8,12],com:[1,8,9],come:10,command:1,common:[0,12],compliant:6,compon:10,comput:[2,3,7,8,9,10,11],compute_accuraci:12,compute_dp_sgd_privaci:1,compute_rdp:9,concret:0,condit:5,constant:[0,10],constantflatclipp:0,constantperlayerclipp:0,constraint:7,consum:10,consumpt:10,contain:[0,10],contrast:2,contribut:8,conv2d:5,converg:6,convert:[6,10],convert_batchnorm_modul:6,correct:8,correspond:[0,5,7,8,10],cost:10,could:[7,12],cover:12,cpu:10,creat:12,creation:5,criterion:10,cuda:10,current:[2,8,10,12],cybertronai:8,dataload:10,dataset:[1,10],defin:[2,7,10],delta:[1,9,10],depend:[0,9],desir:0,detach:10,detail:6,determin:8,deviat:[1,9,10],devic:10,dict:[8,12],dictionari:12,differ:[0,7],differenti:[7,9,10,12],dim:13,dimens:[0,2,7,8,10,13],directli:[10,12],disabl:8,disable_hook:8,discard:10,displai:12,doc:10,doe:[5,10],don:12,downstream:8,dp_multihead_attent:2,dpmultiheadattent:[3,4],dropout:2,dtype:9,dure:[8,12],each:[0,7,10,13],easier:12,effect:[0,10],effici:10,element:2,els:[7,8,10],embed:2,embed_dim:2,enabl:[1,8,10],enable_hook:8,encapsul:7,end:2,engin:[2,3,6,7],ensur:[7,10],enter:1,entir:7,enumer:[0,10],epoch:[1,10],eps:6,epsilon:[1,9,10,12],equal:[0,6,9],eras:10,estim:1,etc:[5,6,12],evalu:5,everi:[2,10,12],evolv:12,examin:5,exampl:[1,2,5,6,7,8,9,10,12,13],except:13,exclud:13,exist:12,experi:10,extern:12,factor:0,fals:[0,2,5,7,8,10],far:10,field:[7,10],file:12,find:1,first:[7,8,10,13],fit:10,flag:[0,5,7,8,10,13],flat:[0,7,13],flat_valu:0,flatten:7,follow:[7,10,12],former:2,forward:[2,8],frequenc:12,friendli:2,from:[1,2,6,7,8,10,12,13],full:2,gather:12,gaussian:[1,7,9,10],gener:[10,12,13],get:[5,7,10,12],get_layer_typ:5,get_privacy_sp:[9,10],github:[1,8,9],given:[0,5,6,8,9,12,13],global:[8,12],googl:[1,9],gpu:10,grad:[3,7],grad_norm_typ:10,grad_sampl:[7,8,10],gradient:[0,2,3,5,10,12],greater:[1,7,10],groupnorm:6,guarante:[9,10],hack:8,handl:10,has:[2,5,7,8,10],has_no_param:5,have:[2,5,6,7,9,10,12],heavili:6,here:[5,7,9,10],higher:10,hold:5,hook:[2,7,8],how:[10,12],howev:8,html:[2,10],http:[1,2,8,9,10],hypothesi:5,idea:10,ident:6,identifi:12,ignor:[2,13],imagin:10,implement:[0,2,8,12],impli:[7,8],includ:[5,6],index:3,indic:[0,5,7,8,10],inf:9,init:10,initi:[2,10],inject:10,input:[1,2,7,8,10,13],insid:[10,12],insight:12,inspect:[3,14],inspector:5,instal:8,instanc:[2,6,10,12],instanti:[0,10,12],instead:[0,2,12],interfac:12,intern:[2,12],involv:[0,7],is_per_lay:0,is_support:8,isinst:5,isn:6,issu:8,iter:[0,1,9,10,12,13],its:[0,7],itself:10,just:[7,10,12],kdim:2,keep:[7,10,13],kei:2,key_padding_mask:2,known:8,lambda:[5,6],larg:10,larger:10,last:[10,13],later:[10,12],latter:2,layer1:6,layer:[0,2,3,5,6,7,10,13],leaf:5,learnabl:2,length:[2,9,13],less:0,leverag:2,librari:8,like:[5,12],line:[1,10,12],linear:10,list:[0,1,9,10,13],load:2,load_state_dict:2,locat:12,log:12,logit:10,loss:[1,7,8,10,12],loss_reduct:[7,8,10],main:[10,12],mainli:1,make:7,map:8,master:[1,9],match:7,max_grad_norm:10,max_ord:9,maximum:[7,10],mean:[7,8,10,12],mechan:[1,7,9],memori:10,messag:5,meter:12,method:[6,8,10],metric:12,might:10,mini:[7,10],misc_set:10,model:[0,1,5,6,7,8,10],modelinspector:5,modif:[3,14],modifi:6,modul:[2,3,7,8,10,14],module_inspect:5,module_modif:6,monitor:12,monkeypatch:10,most:[0,6,7],move:10,multiheadattent:2,multipl:9,multipli:0,must:[0,5],n_dim:13,n_total_param:7,name:[5,8,12,13],named_param:13,named_valu:12,namespac:12,need:[2,6,8,10,12],need_weight:2,net:0,never:10,next:10,node:5,nois:[1,7,9,10,12],noise_multipli:[1,9,10],non:5,none:[2,5,7,10,12],norm:[0,7,10,12,13],norm_clipp:7,normal:[0,7],normclipp:[0,7],note:[0,5,6,7,8,9,10],now:[8,10],nullify_batchnorm_modul:6,num_head:2,number:[1,9,10,13],nxb:10,object:[0,7,10,12],observ:12,off:10,on_batch_clip_func:7,onc:12,one:[2,6,12],ones:[5,12,13],onli:[5,7,8,10,12],opacu:[0,1,2,5,6,7,8,9,10,12,13],oper:[6,7,8,10],opt_ord:9,optim:[1,7,9,10],option:[5,10,12],order:[1,9,10],org:[2,10],origin:[2,10],original_step:10,other:[10,12],out:12,output:2,over:[7,13],overal:13,overridden:2,own:5,page:3,pair:[1,9,10],param:[8,13],paramet:[0,1,2,5,6,7,8,9,10,12,13],parameter:7,pass:[2,7,8,12],per:[0,2,3,7,10],per_sample_gradient_clip:7,perform:[1,2,10],persamplegradientclipp:7,pleas:2,pointer:10,popul:7,potenti:6,pre_step:7,predic:5,prepar:7,previous:2,print:[1,2,5,6],prior:7,privaci:[3,6,7,11,12],privacy_analysi:9,privacy_engin:[7,10],privacyengin:[7,10],process:[0,1,7,12],propag:8,proper:12,properli:12,properti:0,provid:[5,6,7,8,12],put:7,python:[1,9],pytorch:[2,5,8,10],q_1:9,q_k:9,queri:[2,5,10],rais:[1,9,10],rand:13,randn:2,random:10,rang:[9,10,12],rate:[1,9],rather:10,ratio:[1,9,10],rdp:[1,9,10],rdp_account:9,real:7,realli:0,recip:2,recommend:10,recurs:5,reduct:[7,8,10,12],refer:2,regist:2,register_backward_hook:8,remov:[7,8,10,12],remove_hook:8,renyi:9,repeat:7,repeatedli:10,replac:[6,7],replace_all_modul:6,report:12,repres:[5,7,8,10],requir:5,requires_grad:5,reset:12,resnet18:6,resnet50:6,respect:7,result:[1,12],right:10,root:6,rough:10,row:7,run:[2,9,10],same:[6,9],sampl:[1,2,3,7,9,10,12,13],sample_s:[1,10],sample_stat:12,sampler:3,satisfi:[1,5],save:[2,8],scalar:9,scale:[0,7],script:[1,3],scriptmodul:2,search:3,second:[7,8],secur:10,secure_rng:10,see:[2,10,12],self:0,sensit:[1,7,9,10],separ:0,sequenc:2,sequencebia:2,sequenti:5,set:[5,7,8,10,12,13],set_global_summary_writ:12,set_on_batch_clip_func:7,sgd:[3,10,11],sgm:9,shape:[2,7,8,13],share:[0,2],should:[2,5,7,10],show:10,shown:12,sigma:9,sigma_1:9,sigma_k:9,signific:10,silent:2,similar:12,simpl:5,sinc:2,singl:[0,7],singleton:0,size:[1,2,7,10,13],slice:7,smaller:[7,10],some:12,sourc:[0,1,2,5,6,7,8,9,10,12,13],specif:5,specifi:[0,5],spent:10,stabl:10,standard:[1,9,10],stat:[3,7,13,14],stat_typ:12,state:[2,10],state_dict:2,statist:[7,12],stattyp:12,step:[1,7,9,10],steps_1:9,steps_k:9,stop:12,store:[7,10],str:[5,7,8,10,12,13],strategi:[7,12],string:[5,13],sub:[5,6],subclass:[0,2],submodul:6,suggest:8,sum:[7,8,10,13],sum_over_all_but_batch_and_last_n:13,summary_writ:12,summarywrit:12,suppli:12,support:[2,6,8,12],supported_layers_grad_sampl:8,suppos:9,sure:7,take:[2,7,8,10],target:[1,6,9,10],target_class:6,target_delta:10,tensor:[0,3,7,8,10,14],tensor_attribut:10,tensor_util:13,tensorboard:12,tensorflow:[1,9],tensorflow_privaci:[1,9],test:[5,12],than:[0,1,7,10],thei:7,them:[2,7,8,12],therefor:10,thi:[0,1,2,5,6,7,8,9,10,12,13],thing:12,think:0,threshold:[0,7],thu:[0,7,10],time:[6,7,9,10,12],togeth:[7,10],too:10,top:7,torch:[2,6,7,10,13],torchcsprng:10,torchvis:6,total:7,track:8,train:[1,10,12],tupl:[1,7,9,10,13],turn:10,tutori:2,two:8,type:[0,1,2,5,6,7,8,9,10,12,13],under:[7,12],union:[0,9,10],uniqu:12,unless:5,unnecessarili:12,unsupport:10,updat:[9,12],upon:5,upper:0,usag:10,use:[10,12],used:[0,7,12],useful:6,using:[5,6,8,12],usual:10,util:[3,5,6,12],val:12,valid:[5,10,12],valu:[0,2,5,6,7,8,9,10,12],valueerror:[1,9,10],vdim:2,vector:7,verbos:1,veri:8,verifi:8,view:12,violat:5,virtual:10,virtual_step:10,visual:12,wai:[0,8],want:[10,12],weight:10,welcom:8,were:7,what_is_state_dict:2,when:[0,1,7,9,10,13],whenev:10,where:[2,7,12,13],whether:[0,8],which:[1,5,6,7,8,9,10],whose:5,wish:9,within:2,without:7,work:7,would:[9,10],wrapper:12,you:[1,7,10,12],your:[8,10,12],zero:13,zero_grad:10,zeros_lik:9},titles:["Clipping Utils","Compute DP-SGD Privacy","DPMultiheadAttention","Opacus API Reference","DP Layers","Module Inspection","Module Modification","Gradient Clipping","Per Sample Gradients","Privacy Analysis","Privacy Engine","Scripts","Stats","Tensor Utils","Utils"],titleterms:{analysi:9,api:3,autograd:8,clip:[0,7],comput:1,dpmultiheadattent:2,engin:10,grad:8,gradient:[7,8],indic:3,inspect:5,layer:[4,8],modif:6,modul:[5,6],opacu:3,per:8,privaci:[1,9,10],refer:3,sampl:8,sampler:8,script:11,sgd:1,stat:12,tabl:3,tensor:13,util:[0,13,14]}})