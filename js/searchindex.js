Search.setIndex({docnames:["compute_dp_sgd_privacy","dp_multihead_attention","index","layers","per_sample_gradient_clip","per_sample_gradients","privacy_analysis","privacy_engine","scripts","stats","tensor_utils","utils"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["compute_dp_sgd_privacy.rst","dp_multihead_attention.rst","index.rst","layers.rst","per_sample_gradient_clip.rst","per_sample_gradients.rst","privacy_analysis.rst","privacy_engine.rst","scripts.rst","stats.rst","tensor_utils.rst","utils.rst"],objects:{"opacus.autograd_grad_sample":{add_hooks:[5,1,1,""],disable_hooks:[5,1,1,""],enable_hooks:[5,1,1,""],is_supported:[5,1,1,""],remove_hooks:[5,1,1,""]},"opacus.layers":{dp_multihead_attention:[1,0,0,"-"]},"opacus.layers.dp_multihead_attention":{DPMultiheadAttention:[1,2,1,""],SequenceBias:[1,2,1,""]},"opacus.layers.dp_multihead_attention.DPMultiheadAttention":{forward:[1,3,1,""],load_state_dict:[1,3,1,""]},"opacus.layers.dp_multihead_attention.SequenceBias":{bias:[1,4,1,""],forward:[1,3,1,""]},"opacus.per_sample_gradient_clip":{PerSampleGradientClipper:[4,2,1,""]},"opacus.per_sample_gradient_clip.PerSampleGradientClipper":{clip_and_accumulate:[4,3,1,""],close:[4,3,1,""],pre_step:[4,3,1,""],set_on_batch_clip_func:[4,3,1,""]},"opacus.privacy_analysis":{compute_rdp:[6,1,1,""],get_privacy_spent:[6,1,1,""]},"opacus.privacy_engine":{PrivacyEngine:[7,2,1,""]},"opacus.privacy_engine.PrivacyEngine":{attach:[7,3,1,""],detach:[7,3,1,""],get_privacy_spent:[7,3,1,""],step:[7,3,1,""],to:[7,3,1,""],virtual_step:[7,3,1,""]},"opacus.scripts":{compute_dp_sgd_privacy:[0,0,0,"-"]},"opacus.scripts.compute_dp_sgd_privacy":{compute_dp_sgd_privacy:[0,1,1,""]},"opacus.supported_layers_grad_samplers":{_supported_layers_grad_samplers:[5,4,1,""]},"opacus.utils":{stats:[9,0,0,"-"],tensor_utils:[10,0,0,"-"]},"opacus.utils.stats":{Stat:[9,2,1,""],StatType:[9,2,1,""],add:[9,1,1,""],clear:[9,1,1,""],remove:[9,1,1,""],reset:[9,1,1,""],set_global_summary_writer:[9,1,1,""],update:[9,1,1,""]},"opacus.utils.stats.Stat":{log:[9,3,1,""],reset:[9,3,1,""]},"opacus.utils.tensor_utils":{calc_sample_norms:[10,1,1,""],sum_over_all_but_batch_and_last_n:[10,1,1,""]},opacus:{autograd_grad_sample:[5,0,0,"-"],per_sample_gradient_clip:[4,0,0,"-"],privacy_analysis:[6,0,0,"-"],privacy_engine:[7,0,0,"-"],supported_layers_grad_samplers:[5,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","function","Python function"],"2":["py","class","Python class"],"3":["py","method","Python method"],"4":["py","attribute","Python attribute"]},objtypes:{"0":"py:module","1":"py:function","2":"py:class","3":"py:method","4":"py:attribute"},terms:{"0618":10,"0th":10,"100":0,"128":7,"2048":7,"256":0,"5117":10,"598":5,"60000":0,"class":[1,4,7,9],"default":[0,5,7,9],"enum":9,"final":4,"float":[0,6,7,9],"function":[0,1,4,5,6,7,9,10],"import":7,"int":[0,1,4,6,7,10],"return":[0,4,5,6,7,10],"true":[0,1,4,5,7,10],"while":[1,7],For:[1,7],Its:[6,9],That:7,The:[0,4,5,6,7,9],Then:7,Use:9,Used:7,Useful:9,_supported_layers_grad_sampl:5,about:9,acc1:9,acc1_valu:9,account:[0,7],accumul:[4,7,9],accuraci:9,achiev:4,across:9,activ:[5,9],add:[1,5,7,9],add_bias_kv:1,add_hook:5,add_scalar:9,add_zero_attn:1,added:[0,4,5,6,7,9],adding:[4,9],addit:6,advantag:7,affect:[4,9],after:[4,7],afterward:1,aggreg:[4,5,7,10],all:[1,4,5,6,7,9,10],alloc:7,allow:[1,9],alpha:[0,6,7],alreadi:9,altern:7,although:1,alwai:[4,5],amount:7,analysi:[0,2],ani:[7,9],anoth:9,appear:[4,5],appli:[0,4,6],arbitrari:7,arg:9,argument:7,around:9,arrai:6,assum:10,attach:[4,7,9],attn_mask:1,attribut:7,autograd:2,autograd_grad_sampl:5,automat:7,avail:5,averag:[4,7,9],avg:9,b_sz:4,back:4,backprop:5,backpropag:[4,5],backward:[4,5,7],base:[0,1,5,6],batch:[0,1,4,5,7,10],batch_first:[4,5,7],batch_siz:[0,4,5,7],been:5,befor:[4,7],behaviour:5,being:[5,10],benefici:7,best:7,bia:1,blob:[0,6],block:1,bool:[0,4,5,7,10],both:1,bound:4,budget:[0,7],build:1,busi:7,calc_sample_norm:10,calcul:[1,5,10],call:[0,1,4,7,9],callabl:[4,5],can:[0,4,5,6,7,9],cannot:4,captur:5,care:1,cat:4,check:5,clear:9,clip:[2,7,9],clip_and_accumul:4,clipper:[4,7],close:4,code:[0,6,9],collect:[4,5,9],com:[0,5,6],come:7,command:0,common:9,compon:7,comput:[1,2,4,5,6,7,8],compute_accuraci:9,compute_dp_sgd_privaci:0,compute_rdp:6,constant:7,constraint:4,consum:7,consumpt:7,contain:7,contrast:1,contribut:5,convert:7,correct:5,correspond:[4,5,7],cost:7,could:[4,9],cover:9,cpu:7,creat:9,criterion:7,cuda:7,current:[1,5,9],cybertronai:5,dataload:7,dataset:[0,7],defin:[1,4,7],delta:[0,6,7],depend:6,detach:7,determin:5,deviat:[0,6,7],devic:7,dict:[5,9],dictionari:9,differ:4,differenti:[4,6,7,9],dim:10,dimens:[1,4,5,7,10],directli:[7,9],disabl:5,disable_hook:5,discard:7,displai:9,doc:7,doe:7,don:9,downstream:5,dp_multihead_attent:1,dpmultiheadattent:[2,3],dropout:1,dtype:6,dure:[5,9],each:[4,7,10],easier:9,effect:7,effici:7,element:1,els:[4,5,7],embed:1,embed_dim:1,enabl:[0,5,7],enable_hook:5,encapsul:4,end:1,engin:[1,2,4],ensur:[4,7],enter:0,entir:4,enumer:7,epoch:[0,7],epsilon:[0,6,7,9],equal:6,eras:7,estim:0,etc:9,everi:[1,7,9],evolv:9,exampl:[0,1,4,5,6,7,9,10],except:10,exclud:10,exist:9,experi:7,extern:9,fals:[1,4,5,7],far:7,field:[4,7],file:9,find:0,first:[4,5,7,10],fit:7,flag:[4,5,7,10],flat:[4,10],flatten:4,follow:[4,7,9],former:1,forward:[1,5],frequenc:9,friendli:1,from:[0,1,4,5,7,9,10],full:1,gather:9,gaussian:[0,4,6,7],gener:[7,9,10],get:[4,7,9],get_privacy_sp:[6,7],github:[0,5,6],given:[5,6,9,10],global:[5,9],googl:[0,6],gpu:7,grad:[2,4],grad_norm_typ:7,grad_sampl:[4,5,7],gradient:[1,2,7,9],greater:[0,4,7],guarante:[6,7],hack:5,handl:7,has:[1,4,5,7],have:[1,4,6,7,9],here:[4,6,7],higher:7,hook:[1,4,5],how:[7,9],howev:5,html:[1,7],http:[0,1,5,6,7],idea:7,identifi:9,ignor:[1,10],imagin:7,implement:[1,5,9],impli:[4,5],index:2,indic:[4,5,7],inf:6,init:7,initi:[1,7],inject:7,input:[0,1,4,5,7,10],insid:[7,9],insight:9,instal:5,instanc:[1,7,9],instanti:[7,9],instead:[1,9],interfac:9,intern:[1,9],involv:4,is_support:5,issu:5,iter:[0,6,7,9,10],its:4,itself:7,just:[4,7,9],kdim:1,keep:[4,7,10],kei:1,key_padding_mask:1,known:5,larg:7,larger:7,last:[7,10],later:[7,9],latter:1,layer:[1,2,4,7,10],learnabl:1,length:[1,6,10],leverag:1,librari:5,like:9,line:[0,7,9],linear:7,list:[0,6,7,10],load:1,load_state_dict:1,locat:9,log:9,logit:7,loss:[0,4,5,7,9],loss_reduct:[4,5,7],main:[7,9],mainli:0,make:4,map:5,master:[0,6],match:4,max_grad_norm:7,max_ord:6,maximum:[4,7],mean:[4,5,7,9],mechan:[0,4,6],memori:7,meter:9,method:[5,7],metric:9,might:7,mini:[4,7],misc_set:7,model:[0,4,5,7],modul:[1,2,4,5,7],monitor:9,monkeypatch:7,most:4,move:7,multiheadattent:1,multipl:6,n_dim:10,n_total_param:4,name:[5,9,10],named_param:10,named_valu:9,namespac:9,need:[1,5,7,9],need_weight:1,never:7,next:7,nois:[0,4,6,7,9],noise_multipli:[0,6,7],none:[1,4,7,9],norm:[4,7,9,10],norm_clipp:4,normal:4,normclipp:4,note:[4,5,6,7],now:[5,7],num_head:1,number:[0,6,7,10],nxb:7,object:[4,7,9],observ:9,off:7,on_batch_clip_func:4,onc:9,one:[1,9],ones:[9,10],onli:[4,5,7,9],opacu:[0,1,4,5,6,7,9,10],oper:[4,5,7],opt_ord:6,optim:[0,4,6,7],option:[0,7,9],order:[0,6,7],org:[1,7],origin:[1,7],original_step:7,other:[7,9],out:9,output:1,over:[4,10],overal:10,overridden:1,page:2,pair:[0,6,7],param:[5,10],paramet:[0,1,4,5,6,7,9,10],parameter:4,pass:[1,4,5,9],per:[1,2,4,7],per_sample_gradient_clip:4,perform:[0,1,7],persamplegradientclipp:4,pleas:1,pointer:7,popul:4,pre_step:4,prepar:4,previous:1,print:[0,1],prior:4,privaci:[2,4,8,9],privacy_analysi:6,privacy_engin:[4,7],privacyengin:[4,7],process:[0,4,9],propag:5,proper:9,properli:9,provid:[4,5,9],put:4,python:[0,6],pytorch:[1,5,7],q_1:6,q_k:6,queri:[1,7],rais:[0,6,7],rand:10,randn:1,random:7,rang:[6,7,9],rate:[0,6],rather:7,ratio:[0,6,7],rdp:[0,6,7],rdp_account:6,real:4,recip:1,recommend:7,reduct:[4,5,7,9],refer:1,regist:1,register_backward_hook:5,remov:[4,5,7,9],remove_hook:5,renyi:6,repeat:4,repeatedli:7,replac:4,report:9,repres:[4,5,7],reset:9,respect:4,result:[0,9],right:7,rough:7,row:4,run:[1,6,7],same:6,sampl:[0,1,2,4,6,7,9,10],sample_s:[0,7],sample_stat:9,sampler:2,satisfi:0,save:[1,5],scalar:6,scale:4,script:[0,2],scriptmodul:1,search:2,second:[4,5],secur:7,secure_rng:7,see:[1,7,9],sensit:[0,4,6,7],sequenc:1,sequencebia:1,set:[4,5,7,9,10],set_global_summary_writ:9,set_on_batch_clip_func:4,sgd:[2,7,8],sgm:6,shape:[1,4,5,10],share:1,should:[1,4,7],show:7,shown:9,sigma:6,sigma_1:6,sigma_k:6,signific:7,silent:1,similar:9,sinc:1,singl:4,size:[0,1,4,7,10],slice:4,smaller:[4,7],some:9,sourc:[0,1,4,5,6,7,9,10],spent:7,stabl:7,standard:[0,6,7],stat:[2,4,10,11],stat_typ:9,state:[1,7],state_dict:1,statist:[4,9],stattyp:9,step:[0,4,6,7],steps_1:6,steps_k:6,stop:9,store:[4,7],str:[4,5,7,9,10],strategi:[4,9],string:10,subclass:1,suggest:5,sum:[4,5,7,10],sum_over_all_but_batch_and_last_n:10,summary_writ:9,summarywrit:9,suppli:9,support:[1,5,9],supported_layers_grad_sampl:5,suppos:6,sure:4,take:[1,4,5,7],target:[0,6,7],target_delta:7,tensor:[2,4,5,7,11],tensor_attribut:7,tensor_util:10,tensorboard:9,tensorflow:[0,6],tensorflow_privaci:[0,6],test:9,than:[0,4,7],thei:4,them:[1,4,5,9],therefor:7,thi:[0,1,4,5,6,7,9,10],thing:9,threshold:4,thu:[4,7],time:[4,6,7,9],togeth:[4,7],too:7,top:4,torch:[1,4,7,10],torchcsprng:7,total:4,track:5,train:[0,7,9],tupl:[0,4,6,7,10],turn:7,tutori:1,two:5,type:[0,1,4,5,6,7,9,10],under:[4,9],union:7,uniqu:9,unnecessarili:9,unsupport:7,updat:[6,9],usag:7,use:[7,9],used:[4,9],using:[5,9],usual:7,util:[2,4,9],val:9,valid:[7,9],valu:[1,4,5,6,7,9],valueerror:[0,6,7],vdim:1,vector:4,verbos:0,veri:5,verifi:5,view:9,virtual:7,virtual_step:7,visual:9,wai:5,want:[7,9],weight:7,welcom:5,were:4,what_is_state_dict:1,when:[0,4,6,7,10],whenev:7,where:[1,4,9,10],whether:5,which:[0,4,5,6,7],wish:6,within:1,without:4,work:4,would:[6,7],wrapper:9,you:[0,4,7,9],your:[5,7,9],zero:10,zero_grad:7,zeros_lik:6},titles:["Compute DP-SGD Privacy","DPMultiheadAttention","Opacus API Reference","DP Layers","Gradient Clipping","Per Sample Gradients","Privacy Analysis","Privacy Engine","Scripts","Stats","Tensor Utils","Utils"],titleterms:{analysi:6,api:2,autograd:5,clip:4,comput:0,dpmultiheadattent:1,engin:7,grad:5,gradient:[4,5],indic:2,layer:[3,5],opacu:2,per:5,privaci:[0,6,7],refer:2,sampl:5,sampler:5,script:8,sgd:0,stat:9,tabl:2,tensor:10,util:[10,11]}})