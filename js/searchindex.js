Search.setIndex({docnames:["clipping","compute_dp_sgd_privacy","dp_model_inspector","dp_multihead_attention","dp_rnn","index","layers","module_inspection","module_modification","per_sample_gradient_clip","per_sample_gradients","privacy_analysis","privacy_engine","scripts","stats","tensor_utils","utils"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["clipping.rst","compute_dp_sgd_privacy.rst","dp_model_inspector.rst","dp_multihead_attention.rst","dp_rnn.rst","index.rst","layers.rst","module_inspection.rst","module_modification.rst","per_sample_gradient_clip.rst","per_sample_gradients.rst","privacy_analysis.rst","privacy_engine.rst","scripts.rst","stats.rst","tensor_utils.rst","utils.rst"],objects:{"opacus.grad_sample":[[10,0,0,"-","conv"],[10,0,0,"-","dp_multihead_attention"],[10,0,0,"-","dp_rnn"],[10,0,0,"-","embedding"],[10,0,0,"-","grad_sample_module"],[10,0,0,"-","group_norm"],[10,0,0,"-","instance_norm"],[10,0,0,"-","layer_norm"],[10,0,0,"-","linear"],[10,0,0,"-","utils"]],"opacus.grad_sample.conv":[[10,1,1,"","compute_conv_grad_sample"]],"opacus.grad_sample.dp_multihead_attention":[[10,1,1,"","compute_sequence_bias_grad_sample"]],"opacus.grad_sample.dp_rnn":[[10,1,1,"","compute_rnn_linear_grad_sample"]],"opacus.grad_sample.embedding":[[10,1,1,"","compute_embedding_grad_sample"]],"opacus.grad_sample.grad_sample_module":[[10,2,1,"","GradSampleModule"],[10,1,1,"","create_or_accumulate_grad_sample"]],"opacus.grad_sample.grad_sample_module.GradSampleModule":[[10,3,1,"","add_hooks"],[10,3,1,"","capture_backprops_hook"],[10,3,1,"","del_grad_sample"],[10,3,1,"","disable_hooks"],[10,3,1,"","enable_hooks"],[10,3,1,"","forward"],[10,3,1,"","is_supported"],[10,3,1,"","rearrange_grad_samples"],[10,3,1,"","remove_hooks"],[10,3,1,"","set_grad_sample_to_none"],[10,3,1,"","to_standard_module"],[10,3,1,"","validate"],[10,3,1,"","zero_grad"]],"opacus.grad_sample.group_norm":[[10,1,1,"","compute_group_norm_grad_sample"]],"opacus.grad_sample.instance_norm":[[10,1,1,"","compute_instance_norm_grad_sample"]],"opacus.grad_sample.layer_norm":[[10,1,1,"","compute_layer_norm_grad_sample"]],"opacus.grad_sample.linear":[[10,1,1,"","compute_linear_grad_sample"]],"opacus.grad_sample.utils":[[10,1,1,"","register_grad_sampler"]],"opacus.layers":[[3,0,0,"-","dp_multihead_attention"],[4,0,0,"-","dp_rnn"]],"opacus.layers.dp_multihead_attention":[[3,2,1,"","DPMultiheadAttention"],[3,2,1,"","SequenceBias"]],"opacus.layers.dp_multihead_attention.DPMultiheadAttention":[[3,3,1,"","forward"],[3,3,1,"","load_state_dict"]],"opacus.layers.dp_multihead_attention.SequenceBias":[[3,4,1,"","bias"],[3,3,1,"","forward"]],"opacus.layers.dp_rnn":[[4,2,1,"","DPGRU"],[4,2,1,"","DPGRUCell"],[4,2,1,"","DPLSTM"],[4,2,1,"","DPLSTMCell"],[4,2,1,"","DPRNN"],[4,2,1,"","DPRNNBase"],[4,2,1,"","DPRNNCell"],[4,2,1,"","DPRNNCellBase"],[4,2,1,"","RNNLinear"],[4,1,1,"","apply_permutation"]],"opacus.layers.dp_rnn.DPGRUCell":[[4,3,1,"","forward"]],"opacus.layers.dp_rnn.DPLSTMCell":[[4,3,1,"","forward"]],"opacus.layers.dp_rnn.DPRNNBase":[[4,3,1,"","forward"],[4,3,1,"","forward_layer"],[4,3,1,"","iterate_layers"]],"opacus.layers.dp_rnn.DPRNNCell":[[4,3,1,"","forward"]],"opacus.privacy_engine":[[12,2,1,"","PrivacyEngine"]],"opacus.privacy_engine.PrivacyEngine":[[12,3,1,"","get_compatible_module"],[12,3,1,"","get_epsilon"],[12,3,1,"","is_compatible"],[12,3,1,"","make_private"],[12,3,1,"","make_private_with_epsilon"],[12,3,1,"","validate"]],"opacus.scripts":[[1,0,0,"-","compute_dp_sgd_privacy"]],"opacus.scripts.compute_dp_sgd_privacy":[[1,1,1,"","compute_dp_sgd_privacy"]],"opacus.utils":[[15,0,0,"-","tensor_utils"]],"opacus.utils.tensor_utils":[[15,1,1,"","calc_sample_norms"],[15,1,1,"","calc_sample_norms_one_layer"],[15,1,1,"","sum_over_all_but_batch_and_last_n"],[15,1,1,"","unfold2d"],[15,1,1,"","unfold3d"]],opacus:[[12,0,0,"-","privacy_engine"]]},objnames:{"0":["py","module","Python module"],"1":["py","function","Python function"],"2":["py","class","Python class"],"3":["py","method","Python method"],"4":["py","attribute","Python attribute"]},objtypes:{"0":"py:module","1":"py:function","2":"py:class","3":"py:method","4":"py:attribute"},terms:{"0":[1,3,4,12,15],"01":1,"05":[1,12],"0th":15,"1":[1,3,4,10,12,15],"10":1,"100":1,"120":15,"16":3,"1e":1,"2":[1,4,10,15],"20":[1,3],"21":3,"25723":10,"3":[1,4,15],"300":1,"32":15,"361851298":4,"39":1,"4":[3,4,15],"4930":4,"4d":15,"5":[1,4,15],"5d":15,"6":15,"7":15,"abstract":4,"case":10,"class":[3,4,10,12],"default":4,"do":[4,10],"export":4,"final":4,"float":[1,12],"function":[1,3,4,10,12,15],"int":[1,3,4,15],"long":4,"new":12,"return":[1,4,10,12,15],"short":4,"throw":10,"true":[1,3,4,10,12,15],"while":[3,4,10,12],A:[1,4,15],As:10,For:[3,10,12],If:[1,4,10,12],It:[10,15],The:[1,4,10,12],To:1,Will:10,_current_grad_sampl:10,_forward_input:10,_generate_nois:12,account:[1,12],accumul:[4,10],act:12,action:15,activ:10,ad:[1,10,12,15],add:[3,10,12],add_bias_kv:3,add_hook:10,add_zero_attn:3,addit:[4,12],affect:10,after:[4,12],afterward:[3,4,10],aggreg:[10,12,15],all:[3,4,10,12,15],allow:3,along:4,alpha:[1,12],alreadi:10,also:12,although:[3,4,10],alwai:[4,10],an:[1,4,10,15],analysi:[1,5],anh:4,ani:[10,12],api:12,appli:[1,4],apply_permut:4,approxim:12,ar:[10,12],arang:15,arg:[4,10],argument:[4,10,12],arithmet:12,around:12,associ:10,assum:15,assumpt:12,attack:12,attn_mask:3,attribut:[4,10],autograd:10,avail:10,averag:10,b:[4,15],backprop:10,backpropag:10,backward:[4,10],base:[1,3,4,10,12],basi:10,batch:[1,3,4,10,12,15],batch_first:[3,4,10,12],batch_siz:[4,10,12],batch_size_t:4,batchnorm:10,becaus:10,been:12,behav:[10,12],behaviour:10,being:[4,15],belong:10,best:10,between:15,bi:4,bia:[3,4],bidirect:4,blob:1,block:[3,10,15],bool:[1,4,10,12,15],both:[3,4,15],brand:12,budget:[1,12],bug:10,build:[3,10],c:15,c_0:4,c_last:4,c_n:4,c_t:4,calc_sample_norm:15,calc_sample_norms_one_lay:15,calcul:[3,10,12,15],call:[1,3,4,10],can:[1,4,10,12],captur:10,capture_backprops_hook:10,care:[3,4,10],cell:4,cell_param:4,certain:12,check:[10,12],classmethod:[10,12],clear:10,clip:[5,12,16],close:12,code:1,com:[1,4,10],combin:12,command:1,compat:12,complic:10,compon:12,comput:[3,4,5,10,12,13],compute_conv_grad_sampl:10,compute_dp_sgd_privaci:1,compute_embedding_grad_sampl:10,compute_grad_sampl:10,compute_group_norm_grad_sampl:10,compute_instance_norm_grad_sampl:10,compute_layer_norm_grad_sampl:10,compute_linear_grad_sampl:10,compute_rnn_linear_grad_sampl:10,compute_sequence_bias_grad_sampl:10,concaten:4,concept:10,construct:[10,12],contain:4,continu:12,contrast:3,conv1d:10,conv2d:10,conv:10,convolut:10,copi:12,correspond:[4,10,12],could:10,counterpart:12,creat:10,create_or_accumulate_grad_sampl:10,cryptograph:12,cudnn:4,current:[3,10,12],d:[4,15],data:[4,10,12],data_load:12,dataload:12,dataset:[1,12],decor:10,deep:12,def:10,defin:[3,4,10],del_grad_sampl:10,delet:10,delta:[1,12],demo_dataload:12,depend:10,descript:4,detail:[12,15],detect:10,determin:4,deviat:[1,12],dict:10,differ:10,differenti:[1,12],dilat:15,dim:[4,10,15],dimens:[3,4,10,12,15],dir:4,direct:4,disabl:10,disable_hook:10,distribut:12,document:[4,12],doe:[10,12],doesn:[4,10,12],don:10,dp:[3,4,5,12,13],dp_multihead_attent:[3,10],dp_rnn:[4,10],dpgru:[4,10],dpgrucel:4,dplstm:[4,10],dplstmcell:4,dpmultiheadattent:[5,6],dpoptim:12,dprnn:[5,6],dprnnbase:4,dprnncell:4,dprnncellbas:4,drop:4,dropout:[3,4],dure:[10,12],e:[3,4,10],each:[1,4,10,15],effort:10,either:10,element:[3,4],elimin:10,elman:4,els:4,embed:[3,10],embed_dim:3,empti:10,enabl:[1,10,12],enable_hook:10,encapsul:12,end:[3,10],engin:[3,5],enter:1,entir:[10,12],entri:12,epoch:[1,12],epsilon:[1,12],equal:4,equival:[12,15],error:[10,12],estim:1,everi:[3,4,10,12],exactli:10,exampl:[1,3,4,12,15],except:[4,10,15],exclud:15,exist:10,expect:[10,12],explicitli:10,expos:12,ext:4,extend:10,extra:10,extract:15,fals:[3,4,10,12],far:12,featur:4,field:10,find:1,first:[10,12,15],fit:12,fix:12,flag:[10,12,15],flat:[12,15],former:[3,4,10],forward:[3,4,10],forward_lay:4,forward_output:10,found:[10,12],friendli:[3,4],from:[1,3,4,10,15],full:[3,4,10,12],fulli:10,g:[4,10],gain:12,gate:4,gaussian:[1,12],gaussianaccount:12,gdp:12,gener:[12,15],get:4,get_compatible_modul:12,get_epsilon:12,github:[1,4,10],given:[10,12,15],global:10,good:12,googl:1,grad:[4,10],grad_sampl:[4,10],grad_sample_modul:10,gradient:[3,5,12],gradsamplemodul:[10,12],graph:10,greater:1,group_norm:10,groupnorm:10,gru:4,grucel:4,guarante:12,h:[4,15],h_0:4,h_last:4,h_n:4,h_t:4,ha:[3,4,10,12],have:[3,10],help:10,here:4,hi:4,hidden:4,hidden_s:4,higher:12,hook:[3,4,10],how:[10,12],howev:10,html:3,http:[1,3,4,10],hx:4,i:10,ignor:[3,4,10,15],imag:15,implement:[3,4,15],implicit:15,in_featur:4,incom:4,incompat:12,index:5,indic:[10,12],individu:[10,12],infer:4,initi:[3,4],input:[1,3,4,10,12,15],input_s:4,insid:10,inspect:[5,16],instal:[10,12],instanc:[3,4,10],instance_norm:10,instancenorm1d:10,instancenorm2d:10,instancenorm3d:10,instancenorm:10,instead:[3,4,10,12],intern:[3,4],invalid:[10,12],invok:10,is_compat:12,is_pack:4,is_support:10,issu:[4,10],issuecom:4,iter:[1,4,15],iterate_lay:4,its:10,just:12,k:[10,12],kdim:3,keep:15,kei:3,kernel:15,kernel_s:15,key_padding_mask:3,know:10,kwarg:[10,12],l2:[1,12],l:[3,4,15],last:[4,15],latter:[3,4,10],layer:[3,4,5,10,12,15],layer_norm:10,layernorm:10,learnabl:3,least:10,leav:12,length:[3,4,15],leverag:3,librari:10,like:[4,10,12,15],limit:4,line:1,linear:[4,10],list:[1,4,10,12,15],load:[3,4],load_state_dict:3,loader:12,local:15,look:10,loss:[1,10,12],loss_reduct:[10,12],lr:12,lstm:4,lstmcell:4,m:[1,3,10],made:12,mai:10,main:12,mainli:1,make:10,make_priv:12,make_private_with_epsilon:12,mani:4,master:1,math:4,max_batch_len:4,max_batch_s:4,max_grad_norm:12,maximum:12,mean:[10,12],mechan:[1,12],memori:4,method:[10,12,15],mode:4,model:[1,4,5,10,12],modif:[5,16],modifi:12,modul:[3,4,5,12,16],modulevalid:12,more:[10,12,15],much:12,multi:4,multiheadattent:3,multipl:10,multipli:1,must:[4,10],mycustommodel:[10,12],n:3,n_dim:15,name:15,named_param:15,need:[3,4,10],need_weight:3,neg:10,network:4,never:10,next:1,nn:[3,4,10,15],nois:[1,12],noise_gener:12,noise_multipli:[1,12],noise_se:12,non:[4,10,12],none:[3,4,10,12,15],nonlinear:4,norm:[12,15],normal:[10,12],notabl:12,note:[4,10,12],noth:[4,10],notimplementederror:10,now:12,np:15,num_chunk:4,num_direct:4,num_head:3,num_lay:4,number:[1,12,15],object:12,off:10,one:[3,4,10,12],ones:15,onli:[4,10,15],opacu:[1,3,4,10,12,15],oper:[10,12],oppos:12,opposit:10,optim:[1,12],option:12,order:[1,12],org:3,origin:[3,4,12],other:[10,12],otherwis:[10,12],out:10,out_featur:4,output:[3,4,15],over:[1,4,10,12,15],overal:15,overridden:[3,4,10],p:[4,10],packedsequ:4,pad:15,page:5,pair:[1,4,12],param:[10,15],paramet:[1,3,4,10,12,15],pass:[3,4,10,12],per:[3,4,10,12],per_lay:12,perform:[1,3,4,10,12],permut:4,pleas:3,point:[12,15],poisson:12,poisson_sampl:12,possibl:[10,12],prefer:12,prevent:12,previous:3,print:[1,4],privaci:[5,13],privacy_engin:12,privacyengin:12,privat:12,probabl:1,process:10,product:15,proj_siz:4,provid:12,pseudo:12,py:1,python:1,pytorch:[3,4,10,12],queri:3,rais:[1,10,12],raise_if_error:10,rand:15,randn:3,random:12,rate:1,ratio:[1,12],rdp:[1,12],rdpaccount:12,re:10,rearrang:10,rearrange_grad_sampl:10,reason:10,recip:[3,4,10],recommend:10,recurr:[4,10],reduct:[10,12],refer:[3,4],regist:[3,4,10,12],register_grad_sampl:10,regular:10,relat:12,relu:4,remov:10,remove_hook:10,replac:[4,12],repres:[10,12],requir:12,respons:12,responsibilit:12,result:[1,10],revers:4,reverse_lay:4,rng:12,rnn:[4,10],rnnbase:4,rnncell:4,rnnlinear:[4,10],run:[3,4,10,12],s:[1,4,10,12,15],same:[4,10,12,15],sampl:[1,3,4,5,12,15],sample_r:1,sampler:10,satisfi:1,save:[3,10],script:[1,5],scriptmodul:[3,4],search:5,secur:12,secure_mod:12,see:[3,4,12,15],seed:12,select:1,self:4,sensit:[1,12],seq_length:4,sequenc:[3,4],sequencebia:[3,10],sequenti:4,set:[10,12,15],set_grad_sample_to_non:10,set_to_non:10,sgd:[5,12,13],shape:[3,4,10,15],share:[3,4],should:[3,4,10],shuffl:12,side:15,signatur:10,silent:[3,4,10],sinc:[3,4,10],singl:[4,15],size:[1,3,4,15],slide:15,so:[3,10,12],some:[10,12],sourc:[1,3,4,10,12,15],space:15,spatial:15,specif:4,spent:12,standard:[1,4,10,12],stat:[5,15,16],state:[3,4,12],state_dict:3,state_init:4,step:1,still:10,store:[4,10],str:[10,12,15],straightforward:10,strict:10,stride:15,string:15,strong:12,subclass:[3,4,10],submodul:[10,12],success:10,sum:[10,12,15],sum_over_all_but_batch_and_last_n:15,support:[3,4,10,12,15],t1:15,t2:15,t:[4,10,12],take:[3,4,10,12],tanh:4,target:[1,12],target_class_or_class:10,target_delta:12,target_epsilon:12,task:12,technic:12,tensor:[4,5,10,12,16],tensor_util:15,tensorflow:1,tensorflow_privaci:1,term:4,tf:1,than:[1,12],thei:10,them:[3,4,10],thi:[1,3,4,10,12,15],through:4,time:10,timestep:4,to_standard_modul:10,torch:[3,4,10,12,15],torchcsprng:12,trace:10,train:[1,4,12],transform:4,tupl:[1,4,10,12,15],turn:10,tutori:3,type:[1,3,4,10,12,15],unchang:12,under:10,unfeas:12,unfold2d:15,unfold3d:15,unfold:15,union:[4,10,12,15],unit:4,unless:10,unsupport:10,unsupportedmoduleerror:12,updat:12,us:[4,10,12],usual:12,util:[5,10],valid:[5,10,12],validat:10,valu:[3,10,12],valueerror:1,vanilla:12,vdim:3,verbos:1,version:12,view:15,w:15,wa:10,want:[10,12],we:10,what_is_state_dict:3,when:[1,3,4,10,12,15],where:[3,4,10,15],whether:[4,10],which:[1,10,12],why:10,within:[3,4,10],wrap:[10,12],wrapper:12,written:10,x:[3,4,15],xa:4,y:4,you:[1,10,12],your:12,zero:[4,10,15],zero_grad:10},titles:["Clipping Utils","Compute DP-SGD Privacy","Model Validation","DPMultiheadAttention","DPRNN","Opacus API Reference","DP Layers","Module Inspection","Module Modification","Gradient Clipping","Gradient Sample Module","Privacy Analysis","Privacy Engine","Scripts","Stats","Tensor Utils","Utils"],titleterms:{analysi:11,api:5,clip:[0,9],comput:1,dp:[1,6],dpmultiheadattent:3,dprnn:4,engin:12,gradient:[9,10],indic:5,inspect:7,layer:6,model:2,modif:8,modul:[7,8,10],opacu:5,privaci:[1,11,12],refer:5,sampl:10,script:13,sgd:1,stat:14,tabl:5,tensor:15,util:[0,15,16],valid:2}})