Search.setIndex({docnames:["clipping","compute_dp_sgd_privacy","dp_model_inspector","dp_multihead_attention","index","layers","module_inspection","module_modification","per_sample_gradient_clip","per_sample_gradients","privacy_analysis","privacy_engine","scripts","stats","tensor_utils","utils"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["clipping.rst","compute_dp_sgd_privacy.rst","dp_model_inspector.rst","dp_multihead_attention.rst","index.rst","layers.rst","module_inspection.rst","module_modification.rst","per_sample_gradient_clip.rst","per_sample_gradients.rst","privacy_analysis.rst","privacy_engine.rst","scripts.rst","stats.rst","tensor_utils.rst","utils.rst"],objects:{"opacus.autograd_grad_sample":{add_hooks:[9,1,1,""],disable_hooks:[9,1,1,""],enable_hooks:[9,1,1,""],is_supported:[9,1,1,""],remove_hooks:[9,1,1,""]},"opacus.dp_model_inspector":{DPModelInspector:[2,2,1,""],IncompatibleModuleException:[2,4,1,""]},"opacus.dp_model_inspector.DPModelInspector":{validate:[2,3,1,""]},"opacus.layers":{dp_multihead_attention:[3,0,0,"-"]},"opacus.layers.dp_multihead_attention":{DPMultiheadAttention:[3,2,1,""],SequenceBias:[3,2,1,""]},"opacus.layers.dp_multihead_attention.DPMultiheadAttention":{forward:[3,3,1,""],load_state_dict:[3,3,1,""]},"opacus.layers.dp_multihead_attention.SequenceBias":{bias:[3,5,1,""],forward:[3,3,1,""]},"opacus.per_sample_gradient_clip":{PerSampleGradientClipper:[8,2,1,""]},"opacus.per_sample_gradient_clip.PerSampleGradientClipper":{clip_and_accumulate:[8,3,1,""],close:[8,3,1,""],pre_step:[8,3,1,""],set_on_batch_clip_func:[8,3,1,""],zero_grad:[8,3,1,""]},"opacus.privacy_analysis":{compute_rdp:[10,1,1,""],get_privacy_spent:[10,1,1,""]},"opacus.privacy_engine":{PrivacyEngine:[11,2,1,""]},"opacus.privacy_engine.PrivacyEngine":{attach:[11,3,1,""],detach:[11,3,1,""],get_privacy_spent:[11,3,1,""],step:[11,3,1,""],to:[11,3,1,""],virtual_step:[11,3,1,""],zero_grad:[11,3,1,""]},"opacus.scripts":{compute_dp_sgd_privacy:[1,0,0,"-"]},"opacus.scripts.compute_dp_sgd_privacy":{compute_dp_sgd_privacy:[1,1,1,""]},"opacus.supported_layers_grad_samplers":{_supported_layers_grad_samplers:[9,5,1,""]},"opacus.utils":{clipping:[0,0,0,"-"],module_inspection:[6,0,0,"-"],module_modification:[7,0,0,"-"],stats:[13,0,0,"-"],tensor_utils:[14,0,0,"-"]},"opacus.utils.clipping":{ClippingMethod:[0,2,1,""],ConstantFlatClipper:[0,2,1,""],ConstantPerLayerClipper:[0,2,1,""],NormClipper:[0,2,1,""]},"opacus.utils.clipping.ConstantFlatClipper":{calc_clipping_factors:[0,3,1,""],is_per_layer:[0,3,1,""],thresholds:[0,3,1,""]},"opacus.utils.clipping.ConstantPerLayerClipper":{calc_clipping_factors:[0,3,1,""],is_per_layer:[0,3,1,""],thresholds:[0,3,1,""]},"opacus.utils.clipping.NormClipper":{calc_clipping_factors:[0,3,1,""],is_per_layer:[0,3,1,""],thresholds:[0,3,1,""]},"opacus.utils.module_inspection":{ModelInspector:[6,2,1,""],get_layer_type:[6,1,1,""],has_no_param:[6,1,1,""],requires_grad:[6,1,1,""]},"opacus.utils.module_inspection.ModelInspector":{validate:[6,3,1,""]},"opacus.utils.module_modification":{convert_batchnorm_modules:[7,1,1,""],nullify_batchnorm_modules:[7,1,1,""],replace_all_modules:[7,1,1,""]},"opacus.utils.stats":{Stat:[13,2,1,""],StatType:[13,2,1,""],add:[13,1,1,""],clear:[13,1,1,""],remove:[13,1,1,""],reset:[13,1,1,""],set_global_summary_writer:[13,1,1,""],update:[13,1,1,""]},"opacus.utils.stats.Stat":{log:[13,3,1,""],reset:[13,3,1,""]},"opacus.utils.tensor_utils":{calc_sample_norms:[14,1,1,""],sum_over_all_but_batch_and_last_n:[14,1,1,""]},opacus:{autograd_grad_sample:[9,0,0,"-"],dp_model_inspector:[2,0,0,"-"],per_sample_gradient_clip:[8,0,0,"-"],privacy_analysis:[10,0,0,"-"],privacy_engine:[11,0,0,"-"],supported_layers_grad_samplers:[9,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","function","Python function"],"2":["py","class","Python class"],"3":["py","method","Python method"],"4":["py","exception","Python exception"],"5":["py","attribute","Python attribute"]},objtypes:{"0":"py:module","1":"py:function","2":"py:class","3":"py:method","4":"py:exception","5":"py:attribute"},terms:{"0618":14,"0th":14,"100":1,"128":11,"2048":11,"256":1,"5117":14,"598":9,"60000":1,"abstract":0,"boolean":6,"case":[0,2],"class":[0,2,3,6,7,8,11,13],"default":[7,11,13],"enum":13,"final":[0,8],"float":[0,1,10,11,13],"function":[1,3,6,7,8,9,10,11,13,14],"import":[7,11],"int":[1,3,8,10,11,14],"new":0,"return":[0,1,2,6,7,8,9,10,11,14],"throw":2,"true":[0,1,2,3,6,8,9,11,14],"while":[3,11],For:[0,3,11],Its:[10,13],That:11,The:[0,1,2,6,8,9,10,11,13],Then:11,There:8,Use:13,Used:11,Useful:13,_batchnorm:7,_batchnorm_to_groupnorm:7,_supported_layers_grad_sampl:9,about:[6,13],acc1:13,acc1_valu:13,account:[1,11],accross:11,accumul:[8,11,13],accuraci:13,achiev:8,across:13,activ:[2,9,13],add:[3,9,11,13],add_bias_kv:3,add_hook:9,add_scalar:13,add_zero_attn:3,added:[1,8,9,10,11,13],adding:[8,13],addit:10,advantag:11,affect:[7,8,13],after:[8,11],afterward:3,aggreg:[8,9,11,14],all:[0,2,3,6,7,8,9,10,11,13,14],alloc:11,allow:[3,13],alpha:[1,10,11],alreadi:13,altern:11,although:3,alwai:[6,8,9],amount:11,analysi:[1,4],ani:[6,11,13],anoth:[7,13],appear:[8,9],appli:[0,1,6,8,10],arbitrari:11,arg:13,argument:11,around:13,arrai:10,assum:14,attach:[2,8,11,13],attn_mask:3,attribut:[2,8,11],autograd:4,autograd_grad_sampl:9,automat:[8,11],avail:9,averag:[8,11,13],avg:13,avoid:8,b_sz:8,back:8,backprop:9,backpropag:[8,9],backward:[8,9,11],base:[0,1,3,9,10],batch:[1,3,8,9,11,14],batch_first:[8,9,11],batch_siz:[1,8,9,11],batchnorm1d:[2,7],batchnorm2d:7,batchnorm:7,been:[8,9],befor:[0,8,11],behavi:11,behaviour:9,being:[6,9,11,14],benefici:11,best:11,better:0,bia:3,blob:[1,10],block:3,bn1:7,bool:[0,1,2,6,8,9,11,14],both:3,bound:[0,8],budget:[1,11],build:3,busi:11,calc_clipping_factor:0,calc_sample_norm:14,calcul:[0,3,9,14],call:[1,2,3,8,11,13],callabl:[6,7,8,9],can:[1,8,9,10,11,13],cannot:8,cap:0,captur:9,care:3,cat:8,check:[2,6,9],check_leaf_nodes_onli:6,children:6,clean:11,clear:13,clip:[4,11,13,15],clip_and_accumul:8,clipper:[0,8,11],clippingmethod:0,close:8,code:[1,10,13],collect:[8,9,13],com:[1,9,10],come:11,command:1,common:[0,13],compliant:7,compon:11,compris:2,comput:[3,4,8,9,10,11,12],compute_accuraci:13,compute_dp_sgd_privaci:1,compute_rdp:10,concaten:11,concret:0,condit:6,constant:[0,11],constantflatclipp:0,constantperlayerclipp:0,constraint:8,constructor:2,consum:11,consumpt:11,contain:[0,2,11],contrast:3,contribut:9,conv2d:6,converg:7,convert:[7,11],convert_batchnorm_modul:7,correct:9,correspond:[0,6,8,9,11],cost:11,could:[8,13],cover:13,cpu:11,creat:13,creation:6,criterion:11,cuda:11,current:[3,9,11,13],cybertronai:9,dataload:11,dataset:[1,11],defin:[3,8,11],delet:8,delta:[1,10,11],depend:[0,2,10],desir:0,detach:11,detail:[2,7],determin:9,deviat:[1,10,11],devic:11,dict:[9,13],dictionari:13,differ:[0,8],differenti:[8,10,11,13],dim:14,dimens:[0,3,8,9,11,14],directli:[11,13],disabl:9,disable_hook:9,discard:11,displai:13,doc:11,doe:[6,11],don:13,downstream:9,dp_model_inspector:2,dp_multihead_attent:3,dpmodelinspector:2,dpmultiheadattent:[4,5],dropout:3,dtype:10,dure:[9,13],each:[0,2,8,11,14],easier:13,effect:[0,11],effici:11,either:2,element:3,els:[8,9,11],embed:3,embed_dim:3,enabl:[1,9,11],enable_hook:9,encapsul:8,end:3,engin:[3,4,7,8],ensur:[8,11],enter:1,entir:8,enumer:[0,11],epoch:[1,11],eps:7,epsilon:[1,10,11,13],equal:[0,7,10],eras:11,error:2,estim:1,etc:[6,7,13],evalu:6,everi:[3,11,13],evolv:13,examin:6,exampl:[1,2,3,6,7,8,9,10,11,13,14],except:[2,14],exclud:14,exist:13,experi:11,extern:13,factor:0,fail:2,failur:2,fals:[0,2,3,6,8,9,11,13],far:11,field:[8,11],file:13,find:1,first:[8,9,11,14],fit:11,flag:[0,2,6,8,9,11,14],flat:[0,8,14],flat_valu:0,flatten:8,follow:[8,11,13],former:3,forward:[3,9,11],frequenc:13,friendli:3,from:[1,3,7,8,9,11,13,14],full:3,further:8,gather:13,gaussian:[1,8,10,11],gener:[11,13,14],get:[6,8,11,13],get_layer_typ:6,get_privacy_sp:[10,11],github:[1,9,10],given:[0,2,6,7,9,10,13,14],global:[9,13],googl:[1,10],gpu:11,grad:[4,8,13],grad_norm_typ:11,grad_sampl:[8,9,11],gradient:[0,3,4,6,11,13],greater:[1,8,11],groupnorm:7,guarante:[10,11],hack:9,handl:11,has:[3,6,8,9,11],has_no_param:6,have:[3,6,7,8,10,11,13],heavili:7,here:[6,8,10,11],higher:11,hist:13,hold:6,hook:[3,8,9],how:[11,13],howev:9,html:[3,11],http:[1,3,9,10,11],hypothesi:6,idea:11,ident:7,identifi:13,ignor:[3,14],imagin:11,implement:[0,3,9,13],impli:[8,9],includ:[6,7],incompat:2,incompatiblemoduleexcept:2,index:4,indic:[0,6,8,9,11],individu:2,inf:10,init:11,initi:[3,11],inject:11,input:[1,3,8,9,11,14],insid:[11,13],insight:13,inspect:[4,15],inspector:[2,6],instal:9,instanc:[3,7,11,13],instanti:[0,11,13],instead:[0,3,13],intent:11,interfac:13,intern:[3,11,13],invalid_model:2,involv:[0,8],is_per_lay:0,is_support:9,is_valid:2,isinst:6,isn:7,issu:[8,9],iter:[0,1,10,11,13,14],its:[0,2,8],itself:11,just:[8,11,13],kdim:3,keep:[8,11,14],kei:3,key_padding_mask:3,known:9,lambda:[6,7],larg:11,larger:11,last:[11,14],later:[11,13],latter:3,layer1:7,layer:[0,3,4,6,7,8,11,14],leaf:6,learnabl:3,length:[3,10,14],less:0,leverag:3,librari:9,like:[6,13],line:[1,11,13],linear:[2,11],list:[0,1,2,10,11,14],load:3,load_state_dict:3,locat:13,log:13,logit:11,loss:[1,8,9,11,13],loss_reduct:[8,9,11],main:[11,13],mainli:1,make:8,map:9,master:[1,10],match:8,max_grad_norm:11,max_ord:10,maximum:[8,11],mean:[8,9,11,13],measur:8,mechan:[1,8,10],meet:2,memori:11,mention:8,messag:[2,6],meter:13,method:[2,7,9,11],metric:13,might:11,mini:[8,11],misc_set:11,model:[0,1,4,6,7,8,9,11],modelinspector:[2,6],modif:[4,15],modifi:7,modul:[2,3,4,8,9,11,15],module_inspect:6,module_modif:7,monitor:13,monkeypatch:11,most:[0,7,8],move:11,multiheadattent:3,multipl:10,multipli:0,must:[0,6],n_dim:14,n_total_param:8,name:[6,9,13,14],named_param:14,named_valu:13,namespac:13,need:[3,7,9,11,13],need_weight:3,net:0,never:11,next:11,node:6,nois:[1,8,10,11,13],noise_multipli:[1,10,11],non:6,none:[3,6,8,11,13],norm:[0,8,11,14],norm_clipp:8,normal:[0,8],normclipp:[0,8],note:[0,2,6,7,8,9,10,11],now:[9,11],nullify_batchnorm_modul:7,num_head:3,number:[1,10,11,14],nxb:11,object:[0,8,11,13],observ:13,off:11,on_batch_clip_func:8,onc:13,one:[2,3,7,13],ones:[6,13,14],onli:[6,8,9,11,13],opacu:[0,1,2,3,6,7,8,9,10,11,13,14],oper:[7,8,9,11],opt_ord:10,optim:[1,8,10,11],option:[6,11,13],order:[1,10,11],org:[3,11],origin:[3,11],original_step:11,other:[11,13],out:13,output:3,over:[8,14],overal:14,overridden:3,own:6,page:4,pair:[1,10,11],param:[9,14],paramet:[0,1,2,3,6,7,8,9,10,11,13,14],parameter:8,pass:[3,8,9,13],per:[0,3,4,8,11],per_sample_gradient_clip:8,perform:[1,3,11],persamplegradientclipp:8,pleas:3,pointer:11,popul:8,potenti:7,pre_step:8,predic:[2,6],prefer:11,prepar:8,previous:3,print:[1,3,6,7],prior:8,privaci:[4,7,8,12,13],privacy_analysi:10,privacy_engin:[2,8,11],privacyengin:[2,8,11],process:[0,1,8,13],propag:9,proper:13,properli:[8,13],properti:0,provid:[6,7,8,9,13],put:8,python:[1,10],pytorch:[3,6,9,11],q_1:10,q_k:10,queri:[3,6,11],rais:[1,2,10,11],rand:14,randn:3,random:11,rang:[10,11,13],rate:[1,10],rather:11,ratio:[1,10,11],rdp:[1,10,11],rdp_account:10,real:8,realli:0,reason:2,recip:3,recommend:11,recurs:6,reduct:[8,9,11,13],refer:3,regist:3,register_backward_hook:9,regular:8,remov:[8,9,11,13],remove_hook:9,renyi:10,repeat:8,repeatedli:11,replac:[7,8],replace_all_modul:7,report:13,repres:[6,8,9,11],requir:[2,6],requires_grad:6,reset:[11,13],resnet18:7,resnet50:7,respect:8,result:[1,13],right:11,root:7,rough:11,round:11,row:8,run:[2,3,10,11],safeti:8,same:[7,10],sampl:[1,3,4,8,10,11,13,14],sample_s:[1,11],sample_stat:13,sampler:4,satisfi:[1,6],save:[3,9],scalar:10,scale:[0,8],script:[1,4],scriptmodul:3,search:4,second:[8,9],secur:11,secure_rng:11,see:[3,11,13],self:0,sensit:[1,8,10,11],separ:0,sequenc:3,sequencebia:3,sequenti:6,seri:2,set:[6,8,9,11,13,14],set_global_summary_writ:13,set_on_batch_clip_func:8,sgd:[4,11,12],sgm:10,shape:[3,8,9,14],share:[0,3],should:[2,3,6,8,11],should_throw:2,show:11,shown:13,sigma:10,sigma_1:10,sigma_k:10,signific:11,silent:3,similar:13,simpl:6,simul:11,sinc:3,singl:[0,8],singleton:0,size:[1,3,8,11,14],slice:8,smaller:[8,11],some:13,sourc:[0,1,2,3,6,7,8,9,10,11,13,14],specif:6,specifi:[0,6],spent:11,stabl:11,standard:[1,10,11],stat:[4,8,14,15],stat_typ:13,state:[3,11],state_dict:3,statist:[8,13],stattyp:13,statu:11,step:[1,8,10,11],steps_1:10,steps_k:10,stop:13,store:[8,11],str:[6,8,9,11,13,14],strategi:[8,13],string:[6,14],sub:[6,7],subclass:[0,3],submodul:[2,7],success:2,suggest:9,sum:[8,9,11,14],sum_over_all_but_batch_and_last_n:14,summary_writ:13,summarywrit:13,summed_grad:8,suppli:13,support:[3,7,9,13],supported_layers_grad_sampl:9,suppos:10,sure:8,take:[3,8,9,11],target:[1,7,10,11],target_class:7,target_delta:11,tensor:[0,4,8,9,11,15],tensor_attribut:11,tensor_util:14,tensorboard:13,tensorflow:[1,10],tensorflow_privaci:[1,10],test:[6,13],than:[0,1,8,11],thei:[8,11],them:[3,8,9,13],therefor:11,thi:[0,1,2,3,6,7,8,9,10,11,13,14],thing:13,think:0,threshold:[0,8],thrown:2,thu:[0,8,11],time:[7,8,10,11,13],togeth:[8,11],too:11,top:8,torch:[3,7,8,11,14],torchcsprng:11,torchvis:7,total:8,track:9,train:[1,11,13],tupl:[1,8,10,11,14],turn:11,tutori:3,two:[8,9],type:[0,1,2,3,6,7,8,9,10,11,13,14],under:[8,13],union:[0,10,11],uniqu:13,unless:6,unnecessarili:13,unsupport:11,updat:[10,13],upon:6,upper:0,usag:11,use:[8,11,13],used:[0,8,13],useful:7,using:[6,7,9,11,13],usual:11,util:[4,6,7,13],val:13,valid:[4,6,11,13],valid_model:2,valu:[0,3,6,7,8,9,10,11,13],valueerror:[1,10,11],variabl:11,vdim:3,vector:8,verbos:1,veri:9,verifi:9,view:13,violat:6,virtual:11,virtual_step:11,visual:13,wai:[0,9],want:[11,13],weight:11,welcom:9,were:8,what_is_state_dict:3,when:[0,1,8,10,11,14],whenev:11,where:[3,8,13,14],whether:[0,2,9],which:[1,6,7,8,9,10,11],whose:6,wish:10,within:3,without:8,work:8,would:[10,11],wrapper:13,you:[1,8,11,13],your:[9,11,13],zero:14,zero_grad:[8,11],zeros_lik:10},titles:["Clipping Utils","Compute DP-SGD Privacy","Model Validation","DPMultiheadAttention","Opacus API Reference","DP Layers","Module Inspection","Module Modification","Gradient Clipping","Per Sample Gradients","Privacy Analysis","Privacy Engine","Scripts","Stats","Tensor Utils","Utils"],titleterms:{analysi:10,api:4,autograd:9,clip:[0,8],comput:1,dpmultiheadattent:3,engin:11,grad:9,gradient:[8,9],indic:4,inspect:6,layer:[5,9],model:2,modif:7,modul:[6,7],opacu:4,per:9,privaci:[1,10,11],refer:4,sampl:9,sampler:9,script:12,sgd:1,stat:13,tabl:4,tensor:14,util:[0,14,15],valid:2}})